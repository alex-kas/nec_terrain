### Краткая инструкция рутинга NEC Terrain

Для незнакомых с adb/linux/и так далее:
* ВСЕ команды набираются на компьютере в терминале (`cmd` оболочка в windows)
* Одна строка - одна команда
* каждая команда набирается - нажимается enter и ждется результат: новая строка с приглашением
* после исполнения каждой команды на экране пишется, что она сдлелала, и это должно быть в общем нейтральная или положительная информация. Если вы видите что0то типа "file not found" ("файл не найден"), "command not found" ("команда не найдена"), "cannot ..." ("невозможно ...") и так далее, то вероятнее всего команда набрана с ошибкой или отсутствует необходимый файл, или неправильно что-то еще
* большие и маленькие буквы РАЗЛИЧАЮТСЯ
* случайнух знаков НЕТ (кроме тех мест, где я пишу вторую команду, для windows; надеюсь, там по смыслу понятно)

#### Что загружать

Предпочтительно загрузить все в одну директорию на Вашем компьютере

Из папки `recovery/` здесь на github:
* `adbtestgpt.sh (adbtestgpt.bat для windows)`
* `adbr.sh (adbr.bat для windows)`
* `flash_recovery.sh`
* `run_root_shell`
* `sgdisk`
* `kas.recovery.bin`

Из папки `boot/` здесь на github:

* `adbb.sh (adbb.bat для windows)`
* `build.prop`
* `kas.boot.bin`

Из папки `system/` здесь на github:

* `superuser.tar.gz`

#### Карта micro-sd

Вам понадобится карта micro-sd в телефоне. На ней должно быть нсколько гигабайт свободного места
и она должна быть отформатирована, как mbr с разделом.

В linux это значит, что карта видна как
```
/dev/mmcblk0
```
а ее раздел как
```
/dev/mmcblk0p1
```
Еще проще, просматривая карту в программеy `disks` на своем компьтере Вы должны видеть:
```
Partitioning: Master Boot Record
Device: /dev/mmcblk0p1
Contents: vfat
```

В windows это значит, что просматривая свойства карты, в соответствующем окне, в закладке `Volumes` вы должны видеть:
```
Partition style MBR
```
и должен быть показан один 'volume'.

Раздел (volume) должен быть отформатирован как `vfat`

#### Пре-проверка

В linux проверьте, что `adbtestgpt.sh` имеет код доступа  755. Чтобы быть уверенным в этом, просто выполните команду
(будучи в директории, куда все сохранялось при загрузке)
```
chmod 755 adbtestgpt.sh
```
Включите телефон нормально, в стандартный режим. Подключите usb кабель. В linux никаких драйверов **НЕ** нужно.
В случае windows, драйвер (работает в  win7pro_x64) и `adb.exe` есть в папке  `system/` здесь на github, файл `adbfb.tar.gz`.
Также нужно включить в телефоне 'USB debugging'.

Запустите `adb` демон, например вот так
```
sudo adb devices
(adb start-server [для windows])
```
и запустите скрипт (вы должны быть в директории, куда все сохранялось)
```
./adbtestgpt.sh
(adbtestgpt.bat [для windows])
```
Вы увидите таблицу разделов. Основополагающий момент - дырка межда разделами номер 3 и номер 4
```
Number  Start (sector)    End (sector)  Size       Code  Name
   3          425984          557055   64.0 MiB    FFFF  fatallog
   4          589824          590335   256.0 KiB   FFFF  sbl1
```
Она должна быть **абсолютно точно** как написано выше (на нетронутом телефоне).

**Скрипт не принимает решений. Это Вы, кто сравнивает и решает, что делать!**

Если Вас все устраивает - продолжаем!

#### Новое recovery

В linux проверьте, что `adbr.sh` имеет код доступа `755`. Чтобы быть уверенным в этом, просто выполните команду
(будучи в директории, куда все сохранялось при загрузке)
```
chmod 755 adbr.sh
```
Запустите скрипт
```
./adbr.sh
(adbr.bat [для windows])
```
Абсолютно новое recovery установлено!

#### Новый boot

В linux проверьте, что `adbb.sh` имеет код доступа `755`. Чтобы быть уверенным в этом, просто выполните команду
(будучи в директории, куда все сохранялось при загрузке)
```
chmod 755 adbb.sh
```
**Карточка microsd должна быть __в__ телефоне.**

Запустите на своем компьютере
```
./adbb.sh
(adbb.bat [for windows])
```
Для копирования файлов в правильное место на карточке (в папку с имменем `brnects0.715`).

Перезапустите телефон в режиме *recovery*, набрав на своем компьютере
```
adb reboot recovery
```
Дождитесь как минимум логотипа 'NEC'. После логотипа 'NEC' телефон не будет показывать **НИЧЕГО**. Теперь переходите
внутрь оболочки adb (печатаем все на компьтере и далее, но виртуально мы будем в телефоне)
```
adb shell
```
и выполняйте команды внутри оболочки
```
cd /rbin
./flash_boot.sh
```
Теперь выходите из оболочки
```
exit
```
для возврата на свой компьютер и перегружайте телефон
```
adb reboot
```
Новый образ boot установлен!

#### Переразбиение разделов

Sorry, пока короткой инструкции нет.

#### Установка `su` и `Superuser.apk`

Для начала разархивируйте `superuser.tar.gz`

Загрузите телефон в режим  *recovery* нажимай при старте *vol-down+power*. 
Выполните на компьютере из директории, куда все загружалось, следующие команды
```
adb push su /tmp
adb push Superuser.apk /tmp
adb shell
```
последняя клманда перевела Вас в оболочку adb. Продолжайте внутри оболочки:
```
cd /tmp
mount /dev/block/mmcblk0p12 /system
cp su /system/xbin/su
chown 0:0 /system/xbin/su
chmod 6755 /system/xbin/su
ln -s /system/xbin/su /system/bin/su
cp Superuser.apk /system/app
chmod 644 /system/app/Superuser.apk
umount /system
exit
```
Последняя команда вывела Вас из оболочки. Перезагружайте телефон, набирая на компьютере
```
adb reboot
```
После перезагрузки телефона Вы увидите сообщение "Android is upgrading". Это значит, что телефон устанавливает
новую 'системную' программу Superuser.apk

**ГОТОВО! Ваш телефон заручен!**
